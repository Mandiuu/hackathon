<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta property="og:title" content="Roots - Profile">
    <meta property="og:description" content="Complete your health profile on Roots.">
    <meta property="og:type" content="article">
    <meta name="twitter:card" content="summary">
    <title>Roots - Profile</title>
    <link rel="icon" href="root_icon.png">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #F6F3EA;
            margin: 0;
            font-size: 20px;
            font-family: 'Barlow', 'Times New Roman', Times, serif;
            text-rendering: optimizeLegibility;
        }

        .content {
            max-width: 640px;
            margin: auto;
        }

        .header {
            padding: 3em 0;
            position: relative;
            text-align: center;
        }

        h1 {
            font-family: 'Bungee Shade', Georgia, serif;
            font-weight: bold;
            font-size: 4em;
            line-height: 1;
        }

        .subhead {
            font-family: 'Lora', Georgia, serif;
            font-size: 1.2em;
            text-align: center;
            margin-bottom: 2em;
        }

        .auth-buttons {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .auth-buttons button {
            margin-left: 10px;
            background-color: #f05349;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1em;
        }

        .profile-info {
            background-color: #f6f3ea;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            text-align: center;
        }

        .profile-info2 {
            background-color: #f6f3ea;
            padding: 10px;
            border-radius: 10px;
            margin-top: -90px;
            font-size: 1.2em;
            color: #333;
            text-align: center;
        }

        form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-question {
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
        }

        input[type="text"],
        input[type="email"],
        input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
        }

        button {
            background-color: #f05349;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1em;
        }

        .footer {
            background: #F6F3EA;
            text-align: center;
            font-size: 0.8em;
            padding: 4em 0;
        }

        .autocomplete-suggestions {
            border: 1px solid #ddd;
            max-height: 150px;
            overflow-y: auto;
            background-color: #fff;
        }

        .autocomplete-suggestion {
            padding: 10px;
            cursor: pointer;
        }

        .autocomplete-suggestion:hover {
            background-color: #f0f0f0;
        }

        /* Style for cloned condition boxes */
        .separate-box {
            background-color: #f9f9f9;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        /* Hidden summary by default */
        #summary {
            display: none;
        }

        /* Styles for the summary table */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .summary-table th,
        .summary-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        .summary-table th {
            background-color: #23967F;
            color: white;
        }

        .summary-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <div class="header">
     

        <!-- Top-right buttons -->
        <div class="auth-buttons">
            <button id="home-btn">Home</button>
            <button id="forum-btn">Forum</button>
            <button id="logout-btn">Log Out</button>
        </div>
    </div>

    <div class="content">
        <div class="profile-info">
            <p><strong>Welcome!</strong></p>
        </div>

        <div class="profile-info2">
            <p><strong>Fill this form with your medical history.</strong></p>
            <p><strong>Your family ID is <strong>DL1234</strong>. Share it with them <a href="http://www.example.com">here</a></strong></p>
        </div>

        <form id="profile-form">
            <div class="form-question">
                <label>What was your gender at birth?</label><br>
                <input type="radio" id="gender-yes" name="gender" value="Female">
                <label for="gender-yes">Female</label><br>
                <input type="radio" id="gender-no" name="gender" value="Male">
                <label for="gender-no">Male</label><br>
                <input type="radio" id="gender-m" name="gender" value="NA">
                <label for="gender-m">Prefers not to answer</label><br>
            </div>

            <div class="form-question">
                <label>Were you adopted?</label><br>
                <input type="radio" id="adopted-yes" name="adopted" value="Yes">
                <label for="adopted-yes">Yes</label><br>
                <input type="radio" id="adopted-no" name="adopted" value="No">
                <label for="adopted-no">No</label><br>
            </div>

            <div class="form-question">
                <label>Were you born a twin?</label><br>
                <input type="radio" id="twin-no" name="twin" value="No" required>
                <label for="twin-no">No</label><br>
                <input type="radio" id="twin-identical" name="twin" value="Identical (Same)">
                <label for="twin-identical">Yes, Identical (Same)</label><br>
                <input type="radio" id="twin-fraternal" name="twin" value="Fraternal">
                <label for="twin-fraternal">Yes, Fraternal (Not Identical)</label><br>
            </div>

            <div class="form-question">
                <label>Do you have siblings?</label><br>
                <input type="radio" id="siblings-yes" name="siblings" value="Yes" required>
                <label for="siblings-yes">Yes</label><br>
                <input type="radio" id="siblings-no" name="siblings" value="No">
                <label for="siblings-no">No</label><br>

                <div id="sibling-count" style="display: none;">
                    <label for="num-siblings">How many siblings do you have?</label><br>
                    <input type="number" id="num-siblings" name="num-siblings" min="1" max="20">
                </div>
            </div>

            <div class="form-question">
                <label>Do you have aunts?</label><br>
                <input type="radio" id="aunts-yes" name="aunts" value="Yes" required>
                <label for="aunts-yes">Yes</label><br>
                <input type="radio" id="aunts-no" name="aunts" value="No">
                <label for="aunts-no">No</label><br>

                <div id="aunt-count" style="display: none;">
                    <label for="num-aunts">How many aunts do you have?</label><br>
                    <input type="number" id="num-aunts" name="num-aunts" min="1" max="20">
                </div>
            </div>

            <div class="form-question">
                <label>Do you have uncles?</label><br>
                <input type="radio" id="uncles-yes" name="uncles" value="Yes" required>
                <label for="uncles-yes">Yes</label><br>
                <input type="radio" id="uncles-no" name="uncles" value="No">
                <label for="uncles-no">No</label><br>

                <div id="uncle-count" style="display: none;">
                    <label for="num-uncles">How many uncles do you have?</label><br>
                    <input type="number" id="num-uncles" name="num-uncles" min="1" max="20">
                </div>
            </div>

            <div class="form-question">
                <label>Do you have children?</label><br>
                <input type="radio" id="children-yes" name="children" value="Yes">
                <label for="children-yes">Yes</label><br>
                <input type="radio" id="children-no" name="children" value="No">
                <label for="children-no">No</label><br>

                <div id="children-count" style="display: none;">
                    <label for="num-children">How many children do you have?</label><br>
                    <input type="number" id="num-children" name="num-children" min="1" max="10">
                </div>
            </div>

            <div class="form-question">
                <label>Are you married?</label><br>
                <input type="radio" id="married-yes" name="married" value="Yes">
                <label for="married-yes">Yes</label><br>
                <input type="radio" id="married-no" name="married" value="No">
                <label for="married-no">No</label><br>
            </div>

            <div id="health-condition-section">
                <div class="separate-box">
                    <label for="diseases">Health Conditions</label><br>
                    <input type="text" id="diseases" name="diseases" placeholder="Enter any diseases" required>

                    <label for="treatment">Treatment/Medication</label><br>
                    <input type="text" id="treatment" name="treatment" placeholder="Enter any treatments or medications" style="margin-bottom: 20px;">
                    
                    <label for="age-at-diagnosis">Age at Diagnosis</label><br>
                    <select id="age-at-diagnosis" name="age-at-diagnosis" style="margin-bottom: 20px;">
                        <option value="Newborn">Newborn</option>
                        <option value="Infancy">Infancy</option>
                        <option value="Childhood">Childhood</option>
                        <option value="Adolescence">Adolescence</option>
                        <option value="Adulthood">Adulthood</option>
                        <option value="Specify Year">Specify Year</option>
                    </select>
                </div>
            </div>

            <!-- Button to add another health condition -->
            <button type="button" id="add-condition">Add Another Health Condition</button><br><br>

            <!-- Submit button -->
            <button type="submit">Submit</button>
        </form>

        <!-- Summary -->
        <div id="summary">
            <h2>Health Profile Summary</h2>
            <table class="summary-table" id="summary-table">
                <thead>
                    <tr>
                        <th>Disease</th>
                        <th>Age at Diagnosis</th>
                        <th>Treatment</th>
                    </tr>
                </thead>
                <tbody id="summary-content">
                    <!-- Dynamic content will be injected here -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2024 Roots. All Rights Reserved.</p>
    </div>

    <script>
        let diseasesList = [];

        // Function to fetch the diseases from a .txt file
        async function loadDiseases() {
            try {
                const response = await fetch('cleaned_diseases.txt');
                const text = await response.text();
                diseasesList = text.split('\n').map(disease => disease.trim()).filter(disease => disease); // Clean and split lines
                bindAutocomplete(document.getElementById('diseases')); // Bind autocomplete after loading diseases
            } catch (error) {
                console.error('Error loading diseases:', error);
            }
        }

        // Function to handle autocomplete for disease inputs
        function bindAutocomplete(diseasesInput) {
            diseasesInput.addEventListener('input', function () {
                const value = this.value.toLowerCase();
                const suggestions = diseasesList.filter(disease => disease.toLowerCase().startsWith(value));

                clearSuggestions(diseasesInput);
                if (value && suggestions.length) {
                    showSuggestions(suggestions, diseasesInput);
                }
            });
        }

        // Function to show suggestions
        function showSuggestions(suggestions, diseasesInput) {
            const suggestionsContainer = document.createElement('div');
            suggestionsContainer.classList.add('autocomplete-suggestions');

            suggestions.forEach(suggestion => {
                const suggestionDiv = document.createElement('div');
                suggestionDiv.classList.add('autocomplete-suggestion');
                suggestionDiv.innerText = suggestion;

                suggestionDiv.addEventListener('click', function () {
                    diseasesInput.value = suggestion;
                    clearSuggestions(diseasesInput);
                });

                suggestionsContainer.appendChild(suggestionDiv);
            });

            diseasesInput.parentNode.appendChild(suggestionsContainer);
        }

        function clearSuggestions(diseasesInput) {
            const existingSuggestions = diseasesInput.parentNode.querySelector('.autocomplete-suggestions');
            if (existingSuggestions) {
                existingSuggestions.remove();
            }
        }

        document.addEventListener('click', function (e) {
            if (!e.target.matches('.autocomplete-suggestion')) {
                document.querySelectorAll('.autocomplete-suggestions').forEach(suggestions => suggestions.remove());
            }
        });

        // Load diseases when the page loads
        loadDiseases();

        // Add another health condition
        document.getElementById('add-condition').addEventListener('click', function () {
    const conditionBox = document.querySelector('.separate-box').cloneNode(true);

    // Generate unique IDs for the new fields
    const timestamp = new Date().getTime();
    conditionBox.querySelector('#diseases').id = `diseases-${timestamp}`;
    conditionBox.querySelector('#age-at-diagnosis').id = `age-at-diagnosis-${timestamp}`;
    conditionBox.querySelector('#treatment').id = `treatment-${timestamp}`;
    
    // Clear the fields in the cloned condition box
    conditionBox.querySelector(`#diseases-${timestamp}`).value = '';
    conditionBox.querySelector(`#age-at-diagnosis-${timestamp}`).value = '';
    conditionBox.querySelector(`#treatment-${timestamp}`).value = '';

    // Append the cloned condition box
    document.getElementById('health-condition-section').appendChild(conditionBox);

    // Rebind autocomplete for the new diseases input in the cloned condition box
    bindAutocomplete(conditionBox.querySelector(`#diseases-${timestamp}`));
});


        // Show or hide the specific year input based on age at diagnosis selection
        document.getElementById('health-condition-section').addEventListener('change', function (e) {
            if (e.target.name === 'age-at-diagnosis') {
                const specificYearInput = e.target.parentNode.querySelector('#specific-year');
                if (e.target.value === 'Specify Year') {
                    specificYearInput.style.display = 'block';
                } else {
                    specificYearInput.style.display = 'none';
                }
            }
        });

        // Show sibling, aunt, uncle counts if selected
        document.getElementById('siblings-yes').addEventListener('click', function () {
            document.getElementById('sibling-count').style.display = 'block';
        });
        document.getElementById('siblings-no').addEventListener('click', function () {
            document.getElementById('sibling-count').style.display = 'none';
        });

        document.getElementById('aunts-yes').addEventListener('click', function () {
            document.getElementById('aunt-count').style.display = 'block';
        });
        document.getElementById('aunts-no').addEventListener('click', function () {
            document.getElementById('aunt-count').style.display = 'none';
        });

        document.getElementById('uncles-yes').addEventListener('click', function () {
            document.getElementById('uncle-count').style.display = 'block';
        });
        document.getElementById('uncles-no').addEventListener('click', function () {
            document.getElementById('uncle-count').style.display = 'none';
        });

        document.getElementById('children-yes').addEventListener('click', function () {
            document.getElementById('children-count').style.display = 'block';
        });
        document.getElementById('children-no').addEventListener('click', function () {
            document.getElementById('children-count').style.display = 'none';
        });

        document.getElementById('profile-form').addEventListener('submit', function (e) {
    e.preventDefault(); // Prevent the form from refreshing the page
    
    const formData = {};

    // Collect data from each form field
    formData.gender = document.querySelector('input[name="gender"]:checked').value;
    formData.adopted = document.querySelector('input[name="adopted"]:checked').value;
    formData.twin = document.querySelector('input[name="twin"]:checked').value;
    formData.siblings = document.querySelector('input[name="siblings"]:checked').value;
    formData.siblingCount = formData.siblings === "Yes" ? document.getElementById('num-siblings').value : '0';
    formData.aunts = document.querySelector('input[name="aunts"]:checked').value;
    formData.auntsCount = formData.aunts === "Yes" ? document.getElementById('num-aunts').value : '0';
    formData.uncles = document.querySelector('input[name="uncles"]:checked').value;
    formData.unclesCount = formData.uncles === "Yes" ? document.getElementById('num-uncles').value : '0';
    formData.children = document.querySelector('input[name="children"]:checked').value;
    formData.childrenCount = formData.children === "Yes" ? document.getElementById('num-children').value : '0';
    formData.married = document.querySelector('input[name="married"]:checked').value;

    let healthConditions = [];
    document.querySelectorAll('.separate-box').forEach((box) => {
        const diseases = box.querySelector('input[name="diseases"]').value;
        const ageAtDiagnosis = box.querySelector('select[name="age-at-diagnosis"]').value;
        const treatment = box.querySelector('input[name="treatment"]').value;

        healthConditions.push({ diseases, ageAtDiagnosis, treatment });
    });

    // Clear existing summary content
    const summaryContent = document.getElementById('summary-content');
    summaryContent.innerHTML = ''; // Clear previous entries

    // Create table rows for each health condition
    healthConditions.forEach(condition => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${condition.diseases}</td>
            <td>${condition.ageAtDiagnosis}</td>
            <td>${condition.treatment}</td>
        `;
        summaryContent.appendChild(row);
    });

    // Show summary section
    document.getElementById('summary').style.display = 'block';
});

       

        // Redirect buttons
        document.getElementById('home-btn').addEventListener('click', function () {
            window.location.href = 'index.html';  // Redirect to homepage
        });

        document.getElementById('forum-btn').addEventListener('click', function () {
            window.location.href = 'forum.html';  // Redirect to forum page
        });

        document.getElementById('logout-btn').addEventListener('click', function () {
            window.location.href = 'index.html';  // Redirect to homepage on logout
        });
    </script>
</body>

</html>
